[**@sundaeswap/math**](../../../README.md) • **Docs**

***

# Function: calculateLiquidity()

> **calculateLiquidity**(`a`, `b`, `aReserve`, `bReserve`, `totalLp`, `laf`): `object`

Calculates the liquidity parameters for adding liquidity to a Stableswaps pool.
This function supports mixed deposits where both assets can be deposited in any proportion.

The calculation is based on the change in the sum invariant (D) before and after the deposit.
LP tokens are minted proportionally to the increase in D relative to the old D value.

TODO: Investigate way to optimize actual deposited amounts

## Parameters

• **a**: `bigint`

The amount of token A to deposit.

• **b**: `bigint`

The amount of token B to deposit.

• **aReserve**: `bigint`

The current reserve of token A in the pool.

• **bReserve**: `bigint`

The current reserve of token B in the pool.

• **totalLp**: `bigint`

The total LP tokens for the pool before the deposit.

• **laf**: `bigint`

The linear amplification factor of the pool.

## Returns

`object`

An object containing:
  - nextTotalLp: The total LP tokens for the pool after the deposit.
  - generatedLp: The amount of LP tokens generated by the deposit.
  - shareAfterDeposit: The depositor's share of the pool after the deposit (as a Fraction).
  - aChange: Always 0n for Stableswaps (no refund needed).
  - bChange: Always 0n for Stableswaps (no refund needed).
  - actualDepositedA: The actual amount of A deposited (always equal to input a).
  - actualDepositedB: The actual amount of B deposited (always equal to input b).

### aChange

> **aChange**: `bigint`

### actualDepositedA

> **actualDepositedA**: `bigint` = `a`

### actualDepositedB

> **actualDepositedB**: `bigint` = `b`

### bChange

> **bChange**: `bigint`

### generatedLp

> **generatedLp**: `bigint` = `newLpTokens`

### nextTotalLp

> **nextTotalLp**: `bigint` = `newTotalLpTokens`

### shareAfterDeposit

> **shareAfterDeposit**: `Fraction`

## Throws

If the pool doesn't have enough liquidity (both reserves are zero).

## Throws

If both deposit amounts are zero.

## Defined in

[StableSwapsPool.ts:223](https://github.com/SundaeSwap-finance/sundae-sdk/blob/main/packages/math/src/PoolMath/StableSwapsPool.ts#L223)
